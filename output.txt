/Users/guomingfei/Desktop/warp-nerf-scratch/train.py:196: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.
  img = imageio.imread(first_img_path)
Warp 1.7.0 initialized:
   CUDA not enabled in this build
   Devices:
     "cpu"      : "arm"
   Kernel cache:
     /Users/guomingfei/Library/Caches/warp/1.7.0
Loading NeRF dataset from /Users/guomingfei/Desktop/warp-nerf-scratch/data/nerf_synthetic/lego
Using image dimensions from dataset: 800x800
Using image dimensions from dataset: 800x800
Using image dimensions from dataset: 800x800
Loaded 100 train cameras and 100 train images
Loaded 100 val cameras and 100 val images
Loaded 200 test cameras and 200 test images
Module __main__ f654f96 load on device 'cpu' took 0.51 ms  (cached)
  0%|          | 0/7000 [00:00<?, ?it/s]/Users/guomingfei/Desktop/warp-nerf-scratch/train.py:242: DeprecationWarning: Starting with ImageIO v3 the behavior of this function will switch to that of iio.v3.imread. To keep the current behavior (and make this warning disappear) use `import imageio.v2 as imageio` or call `imageio.v2.imread` directly.
  img = imageio.imread(path)
Module forward 07fbdd7 load on device 'cpu' took 0.22 ms  (cached)
[it 00000] dup=439089 r_med=174.0  α∈[0.100,0.100,0.100] visible=930/1000
Module loss a9648b5 load on device 'cpu' took 0.20 ms  (cached)
loss 0.40406025390625
Module backward 38dc7e9 load on device 'cpu' took 2691.20 ms  (compiled)
dL_dmean2D_np [[ 2.1761886e-04 -3.1794265e-05  0.0000000e+00]
 [ 3.5446010e-05  5.1411935e-05  0.0000000e+00]
 [-6.4933830e-04  5.7639656e-05  0.0000000e+00]
 ...
 [-2.7680075e-05 -4.4757329e-07  0.0000000e+00]
 [-2.7824420e-04  3.0313746e-05  0.0000000e+00]
 [ 2.4830142e-05 -1.3631878e-04  0.0000000e+00]]
dL_dopacity_np [9.30876704e-04 1.69950596e-04 2.07853178e-03 1.92706560e-04
 1.62858283e-04 3.13975092e-04 1.18624572e-04 3.21380823e-04
 2.08866852e-03 1.00106932e-03 2.51621619e-04 1.78997987e-03
 7.84863732e-05 1.45450205e-04 2.20957329e-03 2.81857996e-04
 4.95625194e-04 1.61269028e-03 5.44682960e-04 1.01975980e-04
 7.06312203e-05 1.93831351e-04 2.95632775e-03 2.16454943e-03
 1.96965085e-03 1.15426921e-03 1.95081346e-04 3.51295283e-04
 1.15269584e-04 4.01583558e-04 1.65726920e-03 2.95533915e-04
 1.51237624e-03 1.16614552e-04 1.74044608e-03 6.13797631e-04
 1.09987952e-04 1.87497097e-03 1.25894207e-03 1.92406634e-03
 7.84797710e-04 5.26674383e-04 1.51731656e-03 4.13867790e-04
 6.88645057e-04 2.47228221e-04 3.30467639e-03 4.66733327e-04
 2.00353621e-04 9.50832909e-05 5.91769174e-04 4.19828761e-03
 9.04681394e-04 2.41786096e-04 5.43738191e-04 1.57323491e-04
 8.77202081e-04 1.98335387e-03 1.00876256e-04 2.20618490e-03
 2.67232943e-04 1.15772054e-04 4.25078004e-04 5.78793522e-04
 9.47225373e-04 1.37072022e-03 8.29769357e-04 7.95545930e-04
 7.65290606e-05 6.59560756e-05 3.84625397e-04 5.54019469e-04
 7.09352200e-04 6.57538476e-04 2.52996455e-04 6.13197393e-04
 5.48498356e-04 1.91378291e-04 9.79527133e-04 1.36159617e-03
 2.16772407e-03 1.84323391e-04 3.01841157e-03 5.32276579e-04
 1.25372899e-04 6.85615058e-04 2.12952466e-04 4.98903973e-04
 7.13570509e-04 2.20155809e-04 9.46126005e-04 6.70847076e-04
 5.47766627e-04 8.51847522e-04 1.22174621e-04 1.19442609e-03
 1.25861738e-03 1.67298177e-03 1.44624407e-03 1.43841025e-03
 1.27547223e-03 1.77440594e-03 1.34202244e-04 4.38191695e-04
 1.34213222e-03 2.03199830e-04 4.28945787e-04 7.69175997e-04
 1.52631081e-03 1.14161587e-04 9.66185587e-04 2.01538380e-04
 1.21842837e-03 5.14960149e-04 5.80325315e-04 2.58440431e-03
 1.94572262e-04 1.85553357e-03 3.64979287e-03 4.09370055e-04
 2.65644048e-04 8.86157795e-04 3.46752256e-03 3.17554950e-04
 2.88099935e-03 3.94621806e-04 2.15760316e-04 9.07910930e-04
 6.99929486e-04 1.36233494e-03 4.50516876e-04 1.58203428e-03
 5.57680323e-04 1.82273434e-04 7.74601358e-04 1.71194179e-03
 3.26062378e-04 7.77584151e-04 8.46612675e-05 6.46191591e-04
 1.69639406e-03 2.75701623e-05 3.05846101e-04 3.14364763e-04
 1.28213811e-04 1.30493238e-04 4.27615123e-05 4.77086520e-04
 1.98415667e-03 2.28938268e-04 1.52399356e-04 1.38344898e-04
 1.49860175e-03 2.56630155e-04 1.86541444e-03 1.37612762e-04
 6.25486311e-04 6.32022275e-04 7.49602041e-04 4.73502383e-04
 6.52917370e-04 8.27848911e-04 9.93322115e-04 1.03631974e-04
 4.92755207e-04 1.53817306e-03 2.05555302e-03 1.08202279e-04
 1.83414057e-04 1.92784530e-03 8.97716091e-04 4.34105750e-04
 2.26211338e-03 1.06715201e-03 1.54581515e-03 2.55279127e-04
 1.27902266e-03 5.21228299e-04 2.14561797e-03 1.77055525e-04
 2.22268328e-03 1.78412898e-04 1.97655871e-03 3.84020066e-04
 1.29822560e-03 4.35546186e-04 7.44895544e-04 3.04610439e-04
 6.18097547e-04 4.48919745e-04 4.48704639e-04 7.88004138e-04
 1.56572228e-03 1.44231785e-03 1.02953913e-04 8.95253033e-05
 3.05445661e-04 5.70521297e-05 3.67774075e-04 3.91003938e-04
 2.42690614e-04 2.94810452e-04 1.70439511e-04 1.55802380e-04
 3.15716752e-04 3.35570396e-04 1.37598102e-03 1.10099638e-04
 1.85206081e-04 1.78914401e-04 6.97957468e-04 4.18974305e-05
 2.07725359e-04 2.84171663e-04 2.84693961e-04 9.02549014e-04
 8.79005122e-04 2.43485294e-04 2.91759410e-04 4.00825404e-04
 1.94134028e-03 6.81185847e-05 1.39573865e-04 3.31220595e-04
 7.85262382e-04 2.54034792e-04 1.18861150e-03 1.25869978e-04
 7.71688938e-04 1.51399733e-03 3.68293433e-04 1.10167850e-04
 1.11174071e-03 1.55141309e-03 3.52085801e-04 9.90345026e-04
 1.33204495e-03 1.27681575e-04 2.69489316e-03 2.12284882e-04
 1.85257057e-03 4.59628820e-04 1.95852108e-03 4.99336689e-04
 8.69347714e-05 9.93968220e-04 1.69767431e-04 3.23453394e-04
 1.27411482e-03 5.49849705e-04 1.78818312e-03 5.43725982e-05
 6.66340813e-04 1.96863213e-04 9.37186182e-04 5.97582897e-04
 9.18566075e-04 1.43769546e-04 1.71771841e-04 3.78168828e-04
 2.60798784e-04 4.33209847e-04 1.46593418e-04 4.86372795e-04
 1.49373629e-03 1.41603698e-03 8.55403370e-04 1.03273604e-03
 1.54884218e-03 1.62907271e-03 2.23199953e-03 1.63356028e-03
 7.05434417e-04 4.07999440e-04 2.20279820e-04 6.18806225e-04
 1.42313060e-04 2.14028463e-04 1.07674021e-03 4.10550507e-04
 1.30986108e-03 2.76418112e-04 2.30835448e-03 1.31751600e-04
 2.09583086e-03 3.53898969e-04 9.61212572e-05 3.78535857e-04
 1.15374965e-03 1.63154886e-03 1.27233725e-04 5.99490959e-05
 2.42710416e-03 2.49503646e-04 6.60501246e-04 4.61125543e-04
 5.18700574e-04 1.91706966e-03 9.99153563e-05 1.93725369e-04
 2.80314795e-04 6.25430956e-04 3.36567085e-04 8.25554249e-04
 3.00131476e-04 1.52298948e-03 8.70220101e-05 1.06227421e-03
 1.67568738e-04 7.96173699e-04 1.32792955e-03 2.11600651e-04
 1.86453154e-03 2.78423744e-04 1.49170065e-03 6.84145081e-04
 4.43163153e-04 2.34984691e-04 1.12668240e-04 5.08179597e-04
 1.43097271e-03 3.71235801e-04 3.34148528e-04 1.60900818e-03
 8.24310118e-04 9.93297785e-04 6.04895002e-04 7.58442693e-05
 3.59286962e-04 2.39845875e-04 1.26070692e-03 1.87878075e-04
 1.41553138e-03 1.66688216e-04 3.31687275e-04 8.75084195e-04
 6.52854913e-04 1.22403295e-03 2.00530142e-03 1.74797693e-04
 5.81581087e-04 9.58711200e-04 1.81111437e-03 5.48653770e-04
 1.10943140e-04 4.62476222e-04 1.48799666e-03 2.39204412e-04
 1.03064952e-03 1.76674384e-03 1.43200101e-03 3.09099094e-03
 2.81936489e-04 4.82720789e-04 1.74595159e-04 2.57478416e-04
 3.68129986e-04 1.63752877e-04 4.33359644e-04 3.56525532e-04
 1.03120881e-04 1.95801351e-03 8.48554831e-04 2.52976920e-03
 2.50045880e-04 2.09072095e-04 2.18029629e-04 1.74532074e-03
 6.20866253e-04 6.98599149e-04 1.45065147e-04 2.73193262e-04
 1.75018737e-03 1.16808037e-03 6.11904194e-04 7.04933482e-05
 1.65680103e-04 1.61320422e-04 9.52410992e-05 2.88094307e-04
 1.85157129e-04 3.68397421e-04 1.32716866e-03 7.03874917e-04
 5.77585946e-04 1.39157550e-04 3.37875943e-04 3.04207002e-04
 2.17582844e-03 5.56982341e-05 7.23640609e-04 1.03188830e-03
 3.25836358e-04 1.91357697e-03 7.36330461e-04 2.80900067e-03
 3.10024159e-04 8.41988149e-05 1.25963346e-03 2.22872128e-03
 9.13796684e-05 3.76975979e-04 5.03055016e-05 8.29586352e-04
 2.06440268e-03 1.63653429e-04 5.28370729e-04 1.24903931e-03
 5.20477421e-04 8.90896656e-04 2.82258203e-04 3.04002501e-03
 8.17250635e-04 2.24531488e-03 8.25062511e-04 2.49670207e-04
 6.39550039e-04 1.15062692e-04 7.53749409e-05 5.75911690e-05
 2.04848754e-03 1.69133651e-04 3.24961118e-04 1.73357385e-03
 1.54442794e-04 9.71504429e-04 8.19575915e-04 1.38317235e-03
 1.22201093e-03 1.32037851e-04 9.16634017e-05 6.49665715e-04
 1.10517773e-04 3.93043563e-04 1.12331100e-03 2.66132265e-04
 6.07513008e-04 1.40612666e-03 2.61931418e-04 3.26997579e-05
 3.65438405e-04 1.55781931e-03 2.36030156e-03 2.49889854e-04
 2.77197431e-03 1.23611244e-04 4.99609392e-04 1.60218216e-04
 2.09363076e-04 8.22515925e-04 5.55148174e-04 3.23378306e-04
 4.57404996e-04 2.08749203e-03 3.37193895e-04 2.62602419e-03
 1.44669076e-03 1.56717759e-03 1.22515671e-03 8.89604999e-05
 7.66661426e-04 4.30066750e-04 8.56286380e-04 3.30350071e-04
 7.19960779e-04 4.74091270e-04 1.92337402e-03 1.52059845e-04
 5.35450818e-04 7.84284493e-04 2.32182618e-04 1.82557967e-03
 1.82453834e-04 1.25655133e-04 1.11809443e-03 4.01911209e-04
 4.01280151e-04 2.19839829e-04 2.16463042e-04 2.65773677e-04
 1.33917929e-04 2.65880302e-03 1.33463519e-03 4.17731469e-04
 1.99655583e-03 1.18971837e-03 8.88970913e-04 9.98259202e-05
 9.81921679e-04 4.96920955e-04 6.90285407e-04 1.43291705e-04
 6.34014548e-04 2.38909200e-03 1.42704652e-04 1.64107259e-04
 9.89794848e-04 3.93872993e-04 4.23679856e-04 6.38506783e-04
 1.62516453e-03 4.95576242e-04 2.82526016e-04 3.48603760e-04
 7.70695449e-04 1.24479481e-03 9.13574710e-04 6.32842304e-04
 2.28555422e-04 3.24278779e-04 3.81843478e-04 1.39064708e-04
 9.52952250e-04 2.64113490e-03 5.89883537e-04 4.12741385e-04
 1.00575422e-03 1.33122259e-03 2.03489210e-04 1.37400196e-03
 1.43836645e-04 4.98582434e-04 1.64664219e-04 1.54215202e-03
 1.02981483e-03 1.47662809e-04 3.00375512e-04 1.65743011e-04
 1.97204237e-04 1.67747945e-04 8.50320910e-04 2.33046664e-03
 1.07104788e-04 5.22560033e-04 5.32211736e-04 2.45448813e-04
 2.35784845e-03 9.56860167e-05 1.50722091e-03 3.71036818e-04
 3.92154034e-05 2.35691172e-04 8.19769630e-04 7.22150668e-04
 1.31267635e-03 1.77635156e-04 5.05735807e-04 5.55356150e-04
 2.38172151e-03 6.39876002e-04 2.65351089e-04 3.83858569e-04
 3.31446645e-04 1.38575066e-04 1.56313344e-03 8.71331082e-04
 1.96269201e-03 1.85560936e-03 1.39914220e-04 2.11575520e-04
 9.58169578e-04 2.59291555e-04 3.75642179e-04 4.35299880e-04
 1.95823217e-04 0.00000000e+00 1.64924364e-03 7.70467886e-05
 1.29302804e-04 1.37582619e-03 2.82767141e-04 1.04800926e-03
 1.43792492e-03 9.83010759e-05 8.44894457e-05 1.70368713e-03
 6.13290584e-04 1.56791517e-04 1.03877741e-03 2.06659170e-04
 3.28415656e-04 1.66485691e-03 8.75035475e-04 9.37405101e-04
 1.20728754e-03 1.61857810e-03 5.63256792e-04 1.70872096e-04
 3.41556384e-04 3.34077660e-04 1.36299198e-03 1.81781349e-03
 3.19161081e-05 1.89301922e-04 3.02766974e-04 6.09416689e-04
 1.22175040e-03 3.74027470e-04 3.22093023e-04 2.48553260e-04
 1.97965070e-03 1.93257802e-04 1.38507283e-04 1.51431398e-03
 1.27600884e-04 7.48658262e-04 1.75209891e-04 1.56560936e-03
 7.27336563e-04 2.02288246e-03 1.10428350e-03 1.96418448e-04
 6.86192478e-04 1.26626619e-04 2.23787571e-03 1.35998343e-04
 8.08788347e-04 9.05448978e-04 6.65659201e-04 1.35952418e-04
 4.44277772e-04 3.72276688e-03 4.78029600e-04 5.67757117e-04
 1.46292979e-04 2.25968033e-04 2.67495983e-04 5.03864198e-04
 1.67662848e-03 1.29739125e-03 1.07829541e-03 1.21282204e-03
 5.80128799e-05 1.72630872e-03 2.76803039e-04 1.05907116e-03
 2.91330012e-04 3.82620539e-03 1.07293110e-03 1.39029085e-04
 3.08404822e-04 1.03018142e-03 2.26964912e-04 1.77928701e-03
 2.84463371e-04 8.62719782e-04 1.99696049e-04 7.48609949e-04
 1.46495557e-04 2.61031179e-04 8.54877755e-04 2.37729121e-03
 3.04490997e-04 9.30675087e-05 4.32771776e-04 8.47217452e-05
 1.92426451e-04 3.41137551e-04 3.02828569e-03 8.61727691e-04
 1.86686951e-03 1.74042507e-04 2.27049793e-04 1.26618531e-03
 1.78233546e-04 3.32780794e-04 3.01820430e-04 1.25362654e-03
 4.25107602e-04 1.46424965e-04 3.57593788e-04 4.60667216e-04
 8.21922906e-04 5.22763934e-04 3.30288894e-04 1.39144994e-03
 7.49316940e-04 1.36246404e-03 1.59833988e-04 4.03968850e-04
 3.97685537e-04 1.96887087e-03 1.86199951e-03 6.98222429e-04
 2.68476806e-03 1.56623515e-04 4.52404231e-04 3.59294412e-04
 1.69102056e-03 3.23835644e-04 4.12890193e-04 2.37144111e-03
 1.18274463e-03 6.37494522e-05 4.94828040e-04 1.29977707e-04
 3.68064328e-04 6.43261417e-04 6.93896727e-04 7.04087317e-04
 2.49922904e-03 4.56414884e-04 2.64523644e-03 1.40727707e-03
 2.20400537e-03 1.22791110e-03 1.21162925e-03 7.38083560e-04
 1.15630997e-03 1.48478954e-03 2.63173337e-04 9.47528053e-04
 1.30570261e-03 1.32286001e-03 2.97236547e-04 5.03827876e-04
 4.99192567e-04 1.57622120e-03 3.51455179e-04 1.75446796e-04
 2.05234654e-04 1.08601246e-03 9.64901046e-05 7.95188884e-04
 1.46441755e-03 1.68079248e-04 7.79439506e-05 1.10991503e-04
 2.85911537e-03 1.45003927e-04 1.68198929e-03 2.55978885e-05
 3.10792297e-04 1.53126544e-03 2.48716125e-04 9.61974321e-04
 2.38032453e-03 5.38415625e-04 6.07831462e-04 1.52003055e-03
 8.51253862e-04 3.09682830e-04 3.02258122e-04 5.78200095e-04
 1.04188803e-03 2.04350566e-03 5.35101397e-04 1.18988205e-03
 1.44389900e-03 1.41037372e-03 1.26309798e-03 9.01004823e-04
 2.88269774e-04 8.10951111e-04 1.68997140e-04 2.08165919e-04
 4.78399743e-04 2.20512011e-04 1.14172441e-03 1.51065178e-03
 1.48606763e-04 1.08266715e-03 4.06212348e-04 4.76257526e-04
 1.53012015e-03 9.48463276e-04 4.13492206e-04 2.53772858e-04
 5.42831025e-04 1.26444749e-04 4.43181110e-04 9.44831758e-04
 2.31396698e-04 4.66840254e-04 2.26521108e-04 2.17163004e-03
 1.52678273e-04 9.74035938e-04 6.61144033e-04 1.52405424e-04
 2.80959775e-05 6.99261785e-04 2.94519181e-04 9.95658687e-04
 4.97990462e-04 2.31449958e-03 4.94261389e-04 1.24533675e-04
 1.23399339e-04 2.18186746e-04 6.57046330e-04 9.47160646e-04
 3.59278056e-04 7.38181581e-04 6.59155252e-04 9.50364847e-05
 3.89488298e-04 5.77836821e-04 3.05589958e-04 1.75089261e-03
 1.93912943e-04 6.27381727e-04 1.64708542e-03 2.40552146e-03
 8.31081561e-05 1.35301217e-03 1.42568874e-03 2.70617730e-03
 1.62361038e-03 1.50124775e-03 6.32296316e-04 6.72699884e-04
 1.06323743e-04 1.14985125e-03 3.91815440e-04 5.28397853e-04
 1.75098787e-04 1.61317352e-03 8.57041159e-05 6.52857998e-05
 1.29717891e-03 9.37223260e-04 1.69789215e-04 5.25141426e-04
 1.04353530e-03 5.16261207e-04 1.86826137e-03 3.31828347e-03
 1.04749145e-03 4.32646542e-04 2.71768949e-04 4.27460152e-04
 6.86542422e-04 3.90433561e-04 2.47392082e-03 1.37489673e-03
 1.75888673e-03 5.63991489e-04 1.20539073e-04 5.98378421e-04
 1.13130533e-04 1.80475810e-03 5.27343538e-04 2.17558071e-03
 1.48511594e-04 1.93942129e-03 1.80939533e-04 5.62338217e-04
 1.21315999e-03 1.69368507e-03 6.66841806e-05 6.25639106e-04
 8.18585337e-04 2.62699497e-04 2.62358750e-04 3.43651394e-04
 1.50858937e-03 1.14555376e-04 1.61547528e-03 1.22525569e-04
 1.35713420e-03 2.76579027e-04 1.43594854e-03 1.19133329e-03
 1.51730492e-03 2.70342804e-04 8.30369827e-05 1.97150931e-03
 2.08905502e-03 5.24556381e-04 2.99531588e-04 1.86523714e-04
 7.79960901e-05 2.28198804e-03 4.76129673e-04 1.03988343e-04
 1.39151511e-04 1.10210167e-04 1.67595700e-03 1.28555764e-03
 1.27780600e-04 2.10515660e-04 9.35588498e-04 2.80013657e-04
 1.34329253e-04 7.34739413e-04 1.28908618e-03 1.99140792e-04
 2.38081848e-04 5.47840027e-04 3.02768633e-04 1.00555096e-03
 1.04817795e-04 1.74345463e-04 1.58440857e-03 2.66202813e-04
 2.01151648e-04 2.30028556e-04 1.23654853e-03 1.50285952e-03
 1.98977697e-03 2.05811113e-03 1.12403859e-03 2.40549969e-04
 1.83057052e-03 1.23638497e-03 1.75183755e-04 6.91817491e-04
 7.55119836e-04 3.53679468e-04 1.04746339e-03 1.26545178e-03
 1.80737989e-03 2.46545504e-04 1.29909167e-04 7.77529960e-04
 4.72024927e-04 1.86757854e-04 1.33959518e-04 2.57962919e-03
 9.84621947e-05 1.12440600e-03 2.99852225e-04 7.69131075e-05
 3.29390808e-04 8.41642832e-05 3.46402259e-04 2.84706685e-03
 1.56680751e-03 1.42257742e-03 1.01408060e-03 6.98431861e-04
 1.13951613e-03 2.40545045e-03 7.88591453e-04 1.82171806e-03
 1.25951029e-03 1.73525943e-03 3.09192488e-04 4.44310543e-04
 1.96615903e-04 7.54392473e-04 1.68654748e-04 2.09768303e-03
 1.93917338e-04 1.07863138e-03 2.03602031e-04 1.59788667e-03
 1.63134173e-04 5.20070840e-04 1.80918767e-04 1.34278380e-04
 1.21181693e-04 1.13712763e-03 1.12724199e-03 4.45454876e-04
 8.65036098e-04 2.17706477e-03 2.45149713e-04 7.66306999e-04
 2.22681463e-03 6.12292439e-04 3.97769763e-04 2.10362938e-04
 4.68387560e-04 1.25508860e-03 5.07926452e-05 2.38043838e-04
 1.07383938e-03 6.22550258e-04 8.79762447e-05 4.24253987e-04
 5.06948971e-04 1.48073654e-04 1.69393097e-04 3.02538462e-03
 3.12487537e-04 3.76098993e-04 4.23498335e-04 6.86436761e-05
 2.05333970e-04 1.22499163e-03 3.90221743e-04 1.26879115e-03
 1.01190689e-03 1.18588377e-03 1.52771908e-03 1.84126839e-03
 5.57552325e-04 4.70054452e-04 1.23146034e-04 7.47417449e-04
 3.37652484e-04 1.84591801e-03 8.13671504e-04 3.85235238e-04
 1.12751510e-03 1.68845538e-04 2.90144421e-03 3.22530832e-04]  0%|          | 0/7000 [00:05<?, ?it/s]

